<div class="container mt-5">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="text-center">My Orders</h2>
    <button class="btn btn-primary" (click)="refreshPage()">Refresh</button>
  </div>

  <div *ngIf="errorMessage" class="alert alert-danger">{{ errorMessage }}</div>

  <div class="table-responsive">
    <table class="table table-bordered table-hover" *ngIf="orders.length > 0">
      <thead class="thead-dark">
        <tr>
          <th>Order ID</th>
          <th>Food Id</th>
          <th>Food Name</th>
          <th>Quantity</th>
          <th>Total Amount</th>
          <th>Status</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let order of orders">
          <td>{{ order.orderId }}</td>
          <td>{{ order.food.foodId }}</td>
          <td>{{ order.food.foodName }}</td>
          <td>{{ order.quantity }}</td>
          <td>{{ order.totalAmount | currency: 'INR' }}</td>
          <td>{{ order.orderStatus }}</td>
          <td>
            <!-- Show the button only if the order status is "Delivered" -->
            <button
              *ngIf="order.orderStatus !== 'Delivered'"
              class="btn btn-danger btn-sm"
              (click)="confirmDelete(order)"
            >
              Cancel
            </button>
          </td>
        </tr>
      </tbody>
    </table>
    <p *ngIf="orders.length === 0" class="text-center text-muted">Oops! No records found.</p>
  </div>

  <!-- Confirmation Popup -->
  <div *ngIf="showConfirmation" class="modal fade show d-block" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Confirm Deletion</h5>
          <button type="button" class="close" aria-label="Close" (click)="cancelDelete()">
                     </button>
        </div>
        <div class="modal-body">
          <p>Are you sure you want to delete this order?</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" (click)="deleteOrder()">Yes</button>
          <button type="button" class="btn btn-secondary" (click)="cancelDelete()">No</button>
        </div>
      </div>
    </div>
  </div>
</div>
