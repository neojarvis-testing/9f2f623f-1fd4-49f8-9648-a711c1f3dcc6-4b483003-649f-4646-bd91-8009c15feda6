<div class="order-bg"> 

  <!-- Spinner -->
  <div class="spinner-overlay" *ngIf="isLoading">
    <div class="spinner"></div>
  </div>  

  <!-- Main Container -->
  <div class="container mt-5">
    <h2 class="text-center mb-4">Orders Details</h2>
   
  <div class="table-responsive">
    <table class="table table-bordered table-hover" *ngIf="orders.length > 0">
      <thead class="thead-dark">
        <tr>
          <th>Order ID</th>
          <th>User ID</th>
          <th>Food ID</th>
          <th>Order Date</th>
          <th>Food Name</th>
          <th>Quantity</th>
          <th>Total Amount</th>
          <th>Status</th>
          <th>Action</th>
          <th>Delete</th>
          <th>Profile</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let order of orders">
          <td>{{ order.orderId }}</td>
          <td>{{ order.user.userId }}</td> 
          <td>{{ order.food.foodId }}</td>
          <td>{{ order.orderDate }}</td>
          <td>{{ order.food.foodName }}</td>   
          <td>{{ order.quantity }}</td>
          <td>{{ order.totalAmount | currency:'INR' }}</td>
          <td>{{ order.orderStatus }}</td>
          <td>
            <button class="btn btn-warning btn-sm mr-1" 
                    (click)="updateOrderStatus(order.orderId, 'Making Food')" 
                    *ngIf="order.orderStatus === 'Pending'">Making Food</button>
            <button class="btn btn-info btn-sm mr-1" 
                    (click)="updateOrderStatus(order.orderId, 'On the way')" 
                    *ngIf="order.orderStatus === 'Making Food'">On the way</button>
            <button class="btn btn-success btn-sm mr-1" 
                    (click)="updateOrderStatus(order.orderId, 'Delivered')" 
                    *ngIf="order.orderStatus === 'On the way'">Delivered</button>
          </td>
          <td>
            <button class="btn btn-danger btn-sm"
                      *ngIf="order.orderStatus !== 'Delivered'"
                      (click)="deleteOrder(order.orderId)">Delete
            </button>
          </td>
          <td>
            <button class="btn btn-primary btn-sm" (click)="showUserProfile(order.user.userId)">Show Profile</button>
          </td>
        </tr>
      </tbody>
    </table>
    <p *ngIf="orders.length === 0" class="text-center text-muted">Oops! No records found.</p>
  </div>

    <!-- User Profile Modal -->
    <div class="modal" tabindex="-1" role="dialog" *ngIf="selectedUser">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">User Profile</h5>
            <button type="button" class="close" (click)="closeUserProfile()" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <p><strong>Name:</strong> {{ selectedUser.username }}</p>
            <p><strong>Phone:</strong> {{ selectedUser.mobileNumber }}</p>  
            <p><strong>Email:</strong> {{ selectedUser.email }}</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" (click)="closeUserProfile()">Close</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Order Deleted Success Dialog -->
    <div class="dialog-overlay" *ngIf="showSuccessPopup">
      <div class="dialog-box">
        <p>Order deleted successfully!</p>
        <button class="btn btn-primary" (click)="closeSuccessPopup()">OK</button>
      </div>
    </div>

  </div>
</div>
